# minato Writing Studio レビュー & 評価（2026-02 更新）

## 総合評価
- **総合スコア: 8.4 / 10**
- **結論:** すでに実用性は高く、執筆支援ツールとして十分に魅力的。次の成長ボトルネックは「`App.tsx` の責務分離」と「品質ゲート（lint/test）の整備」。

## 観点別スコア
| 観点 | スコア | 根拠（要点） |
|---|---:|---|
| プロダクト価値 | 9.1 | シーン管理・縦書き・AI推敲など、小説執筆に必要な導線がまとまっている。 |
| UX / UI 一貫性 | 8.4 | 一貫したトーンのUIで、創作フローに沿った操作体系。 |
| セキュリティ設計 | 8.2 | APIプロキシ + Supabase RLS 前提で基本設計は良好。入力バリデーションは追加余地あり。 |
| 保守性 | 6.9 | 状態管理が `src/App.tsx` に集中しており、変更影響範囲が大きい。 |
| 開発体験（DX） | 7.2 | build は安定して通るが、lint/test/typecheck の定常運用が未整備。 |
| 運用性 | 8.0 | Vercel 前提の運用が明快。監視・異常検知の仕組みを加えるとより強い。 |

## 強み（良い点）
1. **ドメイン特化が明確**  
   「書く・推敲する・構成を見る・保存する」が一つの体験として設計されている。
2. **セキュリティの方向性が適切**  
   フロントから直接キーを持たず、`/api/anthropic` 経由にしている点は妥当。
3. **README が実運用まで見据えている**  
   セットアップ、デプロイ、RLS 方針がまとまっていてオンボードしやすい。
4. **PWA を含む配布意識**  
   作業端末に縛られにくい構成で、執筆用途と相性が良い。

## 主な課題と優先度

### P1（最優先）
- **`src/App.tsx` の機能分割**
  - `auth`、`editor`、`scenes`、`ai`、`backup/export` を feature 単位に分離。
  - 目安: `hooks`（データ・状態）と `presentational components`（表示）を分ける。
- **品質ゲート導入**
  - `lint`, `typecheck`, `test` スクリプトを package.json に追加。
  - CI で PR ごとに実行して回 regressions を早期検知。

### P2（高）
- **API バリデーションの粒度向上 (`api/anthropic.js`)**
  - `messages` 配列の各要素について `role/content` 型・長さ・許可値を検証。
  - 上限文字数や配列長の制限で abuse を抑制。
- **エラーハンドリングの標準化 (`src/components/ai/AiPanel.tsx`)**
  - 現在は共通文言のみ。HTTP ステータス別に表示を出し分けると運用しやすい。

### P3（中）
- **状態更新の最適化**
  - 大きい原稿で再レンダリングが増えるため、`useMemo`/`useCallback` や分割レンダリングを検討。
- **運用監視の強化**
  - API 失敗率・レイテンシ・保存エラーの可観測性（Sentry 等）を追加。

## 30日改善プラン（提案）
- **Week 1:** `App.tsx` の責務切り出し設計（機能境界とデータフローの定義）。
- **Week 2:** Lint / Typecheck / 単体テストの導入。主要ユーティリティから着手。
- **Week 3:** API 入力検証とエラー表示統一。UI の失敗時導線を整備。
- **Week 4:** 保存・推敲・エクスポートの E2E スモークテスト追加。

## 検証ログ（今回の確認）
- `npm ci` 実行: 成功（警告のみ）
- `npm run build` 実行: 成功（PWA 生成まで完了）

## 総評
今の段階で十分「使える」レベルに達しています。  
次の成長フェーズは、**機能追加よりも構造改善（分割設計）と品質ゲート整備**に投資することで、速度と安定性を同時に引き上げるのが最適です。
